<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Gantt-7-May</title>
    <style>
    #dataTable{
      position:absolute;
/*n;*/
      height:0px;
      left:-2000px;
    }
    body{
      box-sizing: border-box;
padding:1rem;
    }
    .container{
      padding:1rem;
      margin:0;
      border:1px solid black;
      width:100%;
    }
    table,td,th{
      border:1px solid;
      border-collapse: collapse;
      padding:1rem;
    }
.bar{
  height:2rem;
  color:white;
  background-color: blue;
  margin-top:1rem;
  margin-left:0;
  padding-left:1rem;
  border-radius:.5rem;
  font-size:1.4rem;
}

      </style>
</head>

<body>
    Start Date End Date Price in $ Quantity GST= Price * Qty* 11 Margin = in % Result price= Output = Price * Quantity + GST + Margin
    <table id="dataTable" class="input">
        <thead>
            <th>Task</th>
            <th>sub-task</th>
            <th>start</th>
            <th>end</th>
            <th>$Price</th>
            <th>Qty</th>
            <th>GST</th>
            <th>Margin%</th>
            <th>$Total</th>
            <th>start-pending</th>
            <th>end-pending</th>
        </thead>
        <tr>
            <td>Big Task</td>
            <td>sub-task 1</td>
            <td>2014, 11, 31</td>
            <td>2014, 3, 31</td>
            <td>100</td>
            <td>5</td>
            <td>10</td>
            <td>5</td>
            <td>200</td>
            <td>2016, 1, 1</td>
            <td>false</td>
        </tr>
        <tr>
            <td>Big Task</td>
            <td>sub-task 2</td>
            <td>2014, 1, 1</td>
            <td>2014, 6, 1</td>
            <td>100</td>
            <td>5</td>
            <td>10</td>
            <td>5</td>
            <td>200</td>
            <td>2016, 1, 3</td>
            <td>false</td>

        </tr>
        <tr>
            <td>Big Task</td>
            <td>sub-task 3</td>
            <td>2014, 6, 1</td>
            <td>2014, 11, 1</td>
            <td>100</td>
            <td>5</td>
            <td>10</td>
            <td>5</td>
            <td>200</td>
            <td>false</td>
            <td>false</td>

        </tr>
        <tr>
            <td>Small Task</td>
            <td>sub-task 1</td>
            <td>2014, 1, 31</td>
            <td>2015, 11, 31</td>
            <td>100</td>
            <td>5</td>
            <td>10</td>
            <td>5</td>
            <td>200</td>
            <td>2016, 1, 3</td>
            <td>false</td>

        </tr>
        <tr>
            <td>Small Task</td>
            <td>sub-task 2</td>
            <td>2014, 11, 31</td>
            <td>2015, 11, 31</td>
            <td>100</td>
            <td>5</td>
            <td>10</td>
            <td>5</td>
            <td>200</td>
            <td>false</td>
            <td>false</td>

        </tr>


    </table>
<div class="container"></div>
<script>

var date2num = function(str){
  str=str.split(",").map( (word)=> +(word.trim()) )
  var dte = new Date(str)
  // console.log(dte)
  return dte
}

var max = function(arr) {
        return Math.max.apply(Math, arr)
    }
var min = function(arr) {
        return Math.min.apply(Math, arr)
    }
// date2num ("2014, 11, 31")

function push2arr( tbl, i, j, txtProp, arr ){
  var val = tbl.rows[i].cells[j][txtProp];
  // only parse columns with dates
  if(j!==2&&j!==3&&j!==9&&j!==10)
    return false
  if( !isNaN( date2num(val) ) ){
    ganttData_tables.push( date2num(val) )
  }
}

function buildTable(tbl, i, j, arr){
  var txtProp = ( "innerText" in tbl ) ? "innerText" : "textContent";
  if(j===0)
    arr.push([])
  var val = tbl.rows[i].cells[j][txtProp]
  // console.log(val)
  // console.log("val",val,+val)
  if(!isNaN(+val))val= +val
  arr[arr.length-1].push( val );
}

var tbl = $$("#dataTable")[0]
var ganttData_tables=[]
var ganttData=[]
var _start=2
var _end=3
var _start_pending=9
var txtProp = ( "innerText" in tbl ) ? "innerText" : "textContent";

// grab all dates from date cols to find min, max, range:

for (var i = 1; i < tbl.rows.length; i++)
  for (var j = 0; j < tbl.rows[i].cells.length; j++)
    push2arr( tbl, i, j, txtProp, ganttData_tables );
  console.log("-----")

// push all table values into 2d js array
for (var i = 1; i < tbl.rows.length; i++)
  for (var j = 0; j < tbl.rows[i].cells.length; j++){
    buildTable(tbl, i, j, ganttData)
  }

  day_millisec = 24*60*60*1000;
  minMilliSec=( min( ganttData_tables) - (2*day_millisec) );
  maxMilliSec=( max( ganttData_tables) + 2*day_millisec );
  rangeMillisec=(maxMilliSec-minMilliSec); // add 2 days padding either side
  rangeDays=(maxMilliSec-minMilliSec)/1000/60/60/24; // add 2 days padding either side
for (var i = 0; i < ganttData.length; i++) {
  var tsk = ganttData[i];
  var frac = ( new Date(tsk[3])- new Date(tsk[2]) )/rangeMillisec ;
  var leftStart = ( new Date(tsk[2]) - new Date(minMilliSec) )/rangeMillisec ;
  console.log( "frac", frac );
  tsk.push( frac );
  var style=""
  document.getElementsByClassName("container")[0].appendChild(
    create("div", tsk[2], "bar", frac*100, leftStart*100) )

}

  function create(tagNam, txt, klass, width, leftStart) {
    var tg = document.createElement(tagNam)
    if (txt)
      tg.appendChild(document.createTextNode(txt))
    if (klass)
      tg.className = klass;
    if (width)
      tg.style= "width:"+width+"%;margin-left:"+leftStart+"%;";
    return tg
  }

console.table(ganttData)

console.log("range in days ",rangeDays);
console.log("earliest date ", new Date(minMilliSec).toDateString() );
console.log("latest date ",  new Date(maxMilliSec).toDateString() );

function $$(str, dad){
  return (dad||document).querySelectorAll(str)
}

</script>
</body>

</html>
